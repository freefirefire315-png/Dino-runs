<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://adsgram.ai/sdk.js"></script>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Courier New', Courier, monospace; background: #87CEEB; touch-action: none; -webkit-user-select: none; }
        
        /* Game Container */
        #game { width: 100vw; height: 300px; background: #f7f7f7; position: relative; border-bottom: 4px solid #535353; margin-top: 50px; overflow: hidden; }
        
        /* Background Elements */
        #sun { position: absolute; top: 20px; right: 40px; font-size: 40px; z-index: 1; }
        .cloud { position: absolute; font-size: 30px; color: white; z-index: 1; filter: opacity(0.8); }
        .ground-detail { position: absolute; bottom: 5px; height: 2px; background: #d3d3d3; z-index: 2; }

        /* Characters */
        #dino { width: 50px; height: 50px; position: absolute; bottom: 0; left: 40px; font-size: 44px; z-index: 10; transform: scaleX(-1); will-change: bottom; }
        .obstacle { position: absolute; bottom: 0; display: flex; align-items: center; justify-content: center; z-index: 11; white-space: nowrap; }
        
        /* UI */
        #ui { padding: 10px 20px; display: flex; justify-content: space-between; font-size: 20px; color: #535353; font-weight: bold; background: #f7f7f7; }
        #restart { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border: 3px solid #535353; border-radius: 12px; text-align: center; z-index: 100; box-shadow: 0 0 20px rgba(0,0,0,0.2); }
        button { background: #535353; color: white; border: none; padding: 12px 24px; cursor: pointer; font-family: inherit; font-size: 18px; border-radius: 5px; }
    </style>
</head>
<body onclick="jump()" ontouchstart="jump()">
    <div id="ui">
        <span>HI <span id="high-score">00000</span></span>
        <span id="score">00000</span>
    </div>
    
    <div id="game">
        <div id="sun">‚òÄÔ∏è</div>
        <div id="dino">ü¶ñ</div>
    </div>

    <div id="restart">
        <h2 style="color:#535353; margin:0 0 10px 0;">G A M E  O V E R</h2>
        <button onclick="location.reload()">RETRY</button>
    </div>

<script>
    const dino = document.getElementById("dino");
    const game = document.getElementById("game");
    const scoreTxt = document.getElementById("score");
    const highScoreTxt = document.getElementById("high-score");
    
    let score = 0;
    let gameSpeed = 7; 
    let gameOver = false;
    let velocity = 0;
    let position = 0;
    let gravity = 0.6;

    // Set High Score
    highScoreTxt.innerText = (localStorage.getItem("dino-hi") || "0").padStart(5, '0');

    function jump() {
        if (position === 0 && !gameOver) {
            velocity = 13; 
            requestAnimationFrame(physics);
        }
    }

    function physics() {
        if (gameOver) return;
        position += velocity;
        velocity -= gravity;
        if (position <= 0) {
            position = 0;
            velocity = 0;
            dino.style.bottom = "0px";
            return;
        }
        dino.style.bottom = position + "px";
        requestAnimationFrame(physics);
    }

    function spawnObstacle() {
        if (gameOver) return;
        const ob = document.createElement("div");
        ob.classList.add("obstacle");
        
        let rand = Math.random();
        if (rand < 0.15 && score > 25) { 
            ob.innerHTML = "ü¶Ö"; ob.style.bottom = "70px"; ob.style.fontSize = "35px"; 
        } else if (rand < 0.4) { 
            ob.innerHTML = "üåµüåµ"; ob.style.fontSize = "32px";
        } else if (rand < 0.55 && score > 50) { 
            ob.innerHTML = "üåµüåµüåµ"; ob.style.fontSize = "32px";
        } else { 
            ob.innerHTML = "üåµ"; ob.style.fontSize = "32px";
        }
        
        game.appendChild(ob);
        let left = window.innerWidth;
        
        function move() {
            if (gameOver) return;
            left -= gameSpeed;
            ob.style.left = left + "px";

            let d = dino.getBoundingClientRect();
            let o = ob.getBoundingClientRect();

            // Precise collision
            if (d.right - 15 > o.left && d.left + 15 < o.right && d.bottom - 8 > o.top) {
                endGame();
                return;
            }

            if (left < -150) {
                ob.remove();
                score++;
                scoreTxt.innerText = score.toString().padStart(5, '0');
                if (score % 7 === 0) gameSpeed += 0.3; 
            } else { requestAnimationFrame(move); }
        }
        requestAnimationFrame(move);
        setTimeout(spawnObstacle, Math.random() * 1500 + (1200 - gameSpeed * 20));
    }

    function addCloud() {
        if (gameOver) return;
        const c = document.createElement("div");
        c.className = "cloud";
        c.innerHTML = "‚òÅÔ∏è";
        c.style.top = Math.random() * 80 + "px";
        game.appendChild(c);
        let p = window.innerWidth;
        function m() { p -= 1.5; c.style.left = p + "px"; if (p > -60 && !gameOver) requestAnimationFrame(m); else c.remove(); }
        m();
        setTimeout(addCloud, 3000 + Math.random() * 3000);
    }

    function addGroundDetail() {
        if (gameOver) return;
        const g = document.createElement("div");
        g.className = "ground-detail";
        g.style.width = (Math.random() * 20 + 5) + "px";
        g.style.left = window.innerWidth + "px";
        game.appendChild(g);
        let p = window.innerWidth;
        function m() { p -= gameSpeed; g.style.left = p + "px"; if (p > -30 && !gameOver) requestAnimationFrame(m); else g.remove(); }
        m();
        setTimeout(addGroundDetail, 200);
    }

    function endGame() {
        gameOver = true;
        document.getElementById("restart").style.display = "block";
        if (score > (localStorage.getItem("dino-hi") || 0)) localStorage.setItem("dino-hi", score);
    }

    // Start Game
    spawnObstacle();
    addCloud();
    addGroundDetail();
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();
</script>
</body>
</html>
