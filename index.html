<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dino Run - TON</title>
    <script src="https://app.adsgram.ai/js/adsgram-ad-sdk.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        * { padding: 0; margin: 0; box-sizing: border-box; }
        body { background: #fff; font-family: 'Arial', sans-serif; overflow: hidden; touch-action: manipulation; }
        
        #game-area { 
            width: 100vw; height: 200px; border-bottom: 3px solid #535353; 
            margin-top: 80px; position: relative; background: #fdfdfd; 
        }

        /* DINO - Gray color if image fails */
        #dino { 
            width: 45px; height: 45px; position: absolute; bottom: 0; left: 40px; 
            background-color: #535353; background-image: url('https://img.icons8.com/color/96/t-rex.png'); 
            background-size: contain; background-repeat: no-repeat; z-index: 5;
        }

        /* RUNNING LEGS ANIMATION (Rapid Tilt & Bounce) */
        .running { animation: run-legs 0.2s infinite linear; }
        @keyframes run-legs {
            0% { transform: rotate(0deg) translateY(0); }
            25% { transform: rotate(-8deg) translateY(-4px); }
            50% { transform: rotate(0deg) translateY(0); }
            75% { transform: rotate(8deg) translateY(-4px); }
            100% { transform: rotate(0deg) translateY(0); }
        }

        /* JUMP ANIMATION */
        .jumping { animation: dino-jump 0.6s ease-out; }
        @keyframes dino-jump {
            0% { bottom: 0; }
            45% { bottom: 120px; }
            55% { bottom: 120px; }
            100% { bottom: 0; }
        }

        /* CACTUS - Green color if image fails */
        #cactus { 
            width: 30px; height: 45px; position: absolute; bottom: 0; right: -50px;
            background-color: #2ecc71; background-image: url('https://img.icons8.com/color/96/cactus.png');
            background-size: contain; background-repeat: no-repeat;
        }
        .moving { animation: cactus-move 1.5s infinite linear; }
        @keyframes cactus-move {
            0% { right: -50px; }
            100% { right: 110%; }
        }

        #score { position: absolute; top: 20px; right: 20px; font-size: 22px; font-weight: bold; color: #535353; }
        
        /* OVERLAY SCREEN */
        #overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.85); display: none; flex-direction: column; 
            align-items: center; justify-content: center; color: white; z-index: 100;
        }
        button { 
            padding: 15px 30px; font-size: 18px; border: none; border-radius: 12px; 
            background: #2ecc71; color: white; font-weight: bold; margin-top: 10px; width: 280px; 
        }
    </style>
</head>
<body onclick="doJump()">

    <div id="score">00000</div>
    <div id="game-area">
        <div id="dino" class="running"></div>
        <div id="cactus" class="moving"></div>
    </div>

    <div id="overlay">
        <h1 style="font-size: 40px; margin-bottom: 10px;">GAME OVER</h1>
        <p id="final-score" style="font-size: 20px; margin-bottom: 20px;">Score: 0</p>
        <button onclick="reviveAd()">ðŸ“º WATCH AD TO REVIVE</button>
        <button style="background:#e74c3c;" onclick="location.reload()">ðŸ”„ RESTART</button>
    </div>

    <script>
        // 2. TELL TELEGRAM TO OPEN FULL SCREEN
        window.Telegram.WebApp.ready();
        window.Telegram.WebApp.expand();

        const dino = document.getElementById("dino");
        const cactus = document.getElementById("cactus");
        const scoreBox = document.getElementById("score");
        const overlay = document.getElementById("overlay");

        // 3. YOUR BLOCK ID: 19286
        const adBlockId = "19286"; 
        const AdController = window.Adsgram.init({ blockId: adBlockId });
        
        let score = 0;
        let isDead = false;

        function doJump() {
            if (isDead || dino.classList.contains("jumping")) return;
            dino.classList.remove("running");
            dino.classList.add("jumping");
            setTimeout(() => {
                dino.classList.remove("jumping");
                if (!isDead) dino.classList.add("running");
            }, 600);
        }

        let gameLoop = setInterval(() => {
            if (isDead) return;

            let dBottom = parseInt(window.getComputedStyle(dino).getPropertyValue("bottom"));
            let cLeft = parseInt(window.getComputedStyle(cactus).getPropertyValue("left"));

            // Collision Check
            if (cLeft < 85 && cLeft > 40 && dBottom < 40) {
                isDead = true;
                cactus.classList.remove("moving");
                dino.classList.remove("running");
                overlay.style.display = "flex";
                document.getElementById("final-score").innerHTML = "Score: " + Math.floor(score/5);
            } else {
                score++;
                scoreBox.innerHTML = Math.floor(score/5).toString().padStart(5, '0');
            }
        }, 10);

        async function reviveAd() {
            try {
                const result = await AdController.show();
                if (result.done) {
                    isDead = false;
                    overlay.style.display = "none";
                    cactus.style.right = "-100px";
                    cactus.classList.add("moving");
                    dino.classList.add("running");
                }
            } catch (e) {
                // If ad fails, restart game so user doesn't get stuck
                location.reload();
            }
        }
    </script>
</body>
</html>
